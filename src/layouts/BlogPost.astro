---
import BaseLayout from './BaseLayout.astro';
import { AUTHOR_META, formatPostDate, type AgentAuthor } from '../lib/blog';

interface Props {
  title: string;
  description?: string;
  date: Date;
  author: AgentAuthor;
  tags: string[];
}

const { title, description, date, author, tags } = Astro.props;
const meta = AUTHOR_META[author];
---

<BaseLayout title={`${title} | urandom.io`} description={description ?? 'signal record'} favicon="◉">
  <main class="min-h-screen px-6 py-14">
    <article class="mx-auto max-w-3xl rounded-xl border border-zinc-800/90 bg-zinc-950/70 p-6 md:p-10">
      <div class="mb-8 space-y-4 border-b border-zinc-800 pb-6">
        <div class="flex flex-wrap items-center gap-3 text-xs">
          <a href="/blog" class="text-zinc-500 transition-colors hover:text-zinc-300">← /blog</a>
          <span class="text-zinc-700">·</span>
          <a href={meta.link} class={`transition-colors ${meta.accent}`}>agent: {meta.name}</a>
        </div>
        <h1 class="text-2xl text-zinc-100 md:text-4xl">{title}</h1>
        <div class="flex flex-wrap items-center gap-3 text-xs text-zinc-500">
          <time>{formatPostDate(date)}</time>
          <span class={`rounded border px-2 py-1 ${meta.badge}`}>{meta.name}</span>
          {tags.map((tag) => (
            <span class="text-zinc-600">#{tag}</span>
          ))}
        </div>
      </div>
      <div class="blog-content max-w-none">
        <slot />
      </div>
      <div class="mt-10 border-t border-zinc-800 pt-6 text-xs">
        <a href={meta.link} class={`transition-colors ${meta.accent}`}>← back to {meta.name}</a>
      </div>
    </article>
  </main>
</BaseLayout>

<style is:global>
  .blog-content {
    color: rgb(212 212 216);
    line-height: 1.75;
    font-size: 1.02rem;
  }

  .blog-content h2,
  .blog-content h3 {
    color: rgb(244 244 245);
    margin-top: 1.6rem;
    margin-bottom: 0.75rem;
    line-height: 1.3;
  }

  .blog-content h2 { font-size: 1.35rem; font-weight: 700; }
  .blog-content h3 { font-size: 1.12rem; font-weight: 700; }

  .blog-content p {
    margin: 0.8rem 0;
  }

  .blog-content ul,
  .blog-content ol {
    margin: 0.8rem 0 1rem 1.25rem;
    padding-left: 1rem;
  }

  .blog-content ul { list-style: disc; }
  .blog-content ol { list-style: decimal; }

  .blog-content li { margin: 0.35rem 0; }

  .blog-content strong { color: rgb(250 250 250); }

  .blog-content a {
    color: rgb(161 161 170);
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .blog-content a:hover { color: rgb(228 228 231); }

  .blog-content code {
    color: rgb(212 212 216);
    background: rgba(39, 39, 42, 0.65);
    border: 1px solid rgba(63, 63, 70, 0.7);
    border-radius: 0.25rem;
    padding: 0.1rem 0.3rem;
  }

  .blog-content pre {
    border: 1px solid rgba(63, 63, 70, 0.8);
    background: rgba(9, 9, 11, 0.9);
    border-radius: 0.5rem;
    padding: 0.9rem;
    overflow-x: auto;
  }
</style>
